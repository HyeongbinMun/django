{% extends 'base.html' %}
{% load game_filter %}
{% block content %}
    <h2 class="border-bottom py-2">{{ game.subject }}</h2>
    <div class="container text-center">
        {% for ima in game.game_images_set.all %}
            <img src="{{ima.image.url}}" alt="Ball_bounce_game" class ="img-responsive">
        {% endfor %}
    </div>
    <div>
            {% for ctg in game.category_set.all %}
                    <button type="button" class="btn btn-outline-info btn-sm">{{ ctg.subject }}</button>
            {% endfor %}
    </div>
    <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{ game.content }}</div>
            <div class="d-flex justify-content-end">    
                <div class="badge badge-light p-2 text-left">
                    <div class="md-5">{{ game.author.username }}</div>
                    <div>{{ game.create_date }}</div>
                </div>
            </div>
        </div>
    </div>
    <div class="container my-4">
        <a href="{% url 'play:download' game.id %}" class="btn btn-danger btn-block">PLAY_GAME</a>
    </div>
    <h5 class="border-bottom my-3 py-2">{{game.comment_set.count}}개의 댓글이 있습니다.</h5>
    {% for comment in game.comment_set.all %}
    <div class="card my-1">
        <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{ comment.content }}</div>
            <div class="d-flex justify-content-end">
                <div class="badge badge-light">
                        {{ comment.create_date }}
                </div>
            </div>
            <div class="my text-right">
            <a href="#" class="delete btn btn-sm btn-outline-secondary " 
               data-uri="{% url 'play:comment_delete' comment.id  %}">삭제</a>
        </div>
        </div>
    </div>
    {% endfor %}
    <form action="{% url 'play:comment_create' game.id %}" method="post" class="form-row my-3">
        {% csrf_token %}
        <div class="col-sm-10">
            <textarea name="content" id="content" class="form-control" rows="2"></textarea>
        </div>
        <div class="col">
            <input type="submit" value="댓글등록" class="btn btn-success">
        </div>
    </form>
    <div class="container text-center">
        <a href="{% url 'play:index' %}" class="btn btn-primary">목록으로 돌아가기</a>
    </div>
{% endblock %}
{% block script %}
<script type='text/javascript'>
$(document).ready(function(){
    $(".delete").on('click', function() {
        if(confirm("정말로 삭제하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
});
</script>
{% endblock %}